/*
** objects.c for tetris in /media/villen_l/home/villen_l/rendu/Tek1Semestre2/PSU/PSU_2015_tetris
** 
** Made by Lucas Villeneuve
** Login   <villen_l@epitech.net>
** 
** Started on  Thu Feb 25 21:15:34 2016 Lucas Villeneuve
** Last update Thu Feb 25 22:35:04 2016 Lucas Villeneuve
*/

#include <unistd.h>
#include <ncurses.h>
#include "my.h"

void	delete_letter(char **map, int i)
{
  int	j;

  j = 0;
  while (map[i][j] != 0)
    {
      if (map[i][j] == 'I')
	map[i][j] = ' ';
      j++;
    }
}

void	fall_letter(char **map, t_tetris *tetris)
{
  int	i;
  int	j;
  int	count;
  int	ch;

  i = 1;
  j = 6;
  count = 0;
  while (count < 5)
    {
      if (map[i + 1][j] == '-' || map[i + 1][j] == 'O')
      	{
      	  map[i][j] = 'O';
	  delete_letter(map, i - 1);
      	  i = 1;
	  count++;
      	}
      else
      	{
	  delete_letter(map, i - 1);
      	  map[i][j] = 'I';
      	  i++;
      	}
      ch = getch();
      if (ch == 260 && j > 1)
	j--;
      if (ch == 261 && j < tetris->map_width)
	j++;
      refresh();
      display_map_tetris(map, tetris);
    }
}
